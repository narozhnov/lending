{"version":3,"sources":["components/Invoice/index.js"],"names":[],"mappings":"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","file":"components/Invoice/index.js","sourcesContent":["import _ from 'lodash'\nimport MJMLElement from '../decorators/MJMLElement'\nimport MJTable from '../Table'\nimport numeral from 'numeral'\nimport React, { Component } from 'react'\n\n@MJMLElement({\n  tagName: 'mj-invoice',\n  attributes: {\n    'border': '1px solid #ecedee',\n    'color': '#b9b9b9',\n    'font-family': 'Roboto, Ubuntu, Helvetica, Arial, sans-serif',\n    'font-size': '13px',\n    'intl': 'name:Name;price:Price;quantity:Quantity',\n    'line-height': '22px'\n  }\n})\nclass Invoice extends Component {\n\n  static baseStyles = {\n    th: {\n      fontWeight: 700,\n      padding: '10px 20px',\n      textAlign: 'left',\n      textTransform: 'uppercase'\n    }\n  }\n\n  static intl = {\n    name: 'Name',\n    price: 'Price',\n    quantity: 'Quantity',\n    total: 'Total:'\n  }\n\n  constructor (props) {\n    super(props)\n\n    const format = props.mjAttribute('format')\n    const currencies = format.match(/([^-\\d.,])/g)\n\n    this.items = props.mjml.get('children').filter(child => child.get('tagName') === 'mj-invoice-item')\n    this.format = format.replace(/([^-\\d.,])/g, '$')\n    this.currency = currencies[0] || null\n  }\n\n  styles = this.getStyles()\n\n  getStyles () {\n    const { mjAttribute } = this.props\n\n    const styles = _.merge({}, this.constructor.baseStyles, {\n      table: {\n        color: mjAttribute('color'),\n        fontFamily: mjAttribute('font-family'),\n        fontSize: mjAttribute('font-size'),\n        lineHeight: mjAttribute('line-height')\n      },\n      th: {\n        fontFamily: mjAttribute('font-family'),\n        fontSize: mjAttribute('font-size'),\n        lineHeight: mjAttribute('line-height')\n      },\n      thead: {\n        borderBottom: mjAttribute('border')\n      },\n      tfoot: {\n        borderTop: mjAttribute('border')\n      },\n      total: {\n        fontFamily: mjAttribute('font-family'),\n        fontSize: mjAttribute('font-size'),\n        fontWeight: 700,\n        lineHeight: mjAttribute('line-height'),\n        padding: '10px 20px',\n        textAlign: 'right'\n      }\n    })\n\n    styles.thQuantity = _.merge({}, styles.th, { textAlign: 'right' })\n\n    return styles\n  }\n\n  getIntl () {\n    const { mjAttribute } = this.props\n\n    const intl = _.cloneDeep(this.constructor.intl)\n\n    mjAttribute('intl').split(';').forEach(t => {\n      if (t && t.indexOf(':') != -1) {\n        t = t.split(':')\n        intl[t[0].trim()] = t[1].trim()\n      }\n    })\n\n    return intl\n  }\n\n  getTotal () {\n    const format = this.format\n    const currency = this.currency\n\n    const total = this.items.reduce((prev, item) => {\n      const unitPrice = parseFloat(numeral().unformat(item.getIn(['attributes', 'price'])))\n      const quantity = parseInt(item.getIn(['attributes', 'quantity']))\n\n      return prev + unitPrice * quantity\n    }, 0)\n\n    return numeral(total).format(format).replace(/([^-\\d.,])/g, currency)\n  }\n\n  render () {\n    const { children } = this.props\n    const intl = this.getIntl()\n    const total = this.getTotal()\n\n    return (\n      <MJTable {...this.props}>\n        <thead>\n          <tr style={this.styles.thead}>\n            <th style={this.styles.th}>{intl['name']}</th>\n            <th style={this.styles.th}>{intl['price']}</th>\n            <th style={this.styles.thQuantity}>{intl['quantity']}</th>\n          </tr>\n        </thead>\n        <tbody>\n          {children}\n        </tbody>\n        <tfoot>\n          <tr style={this.styles.tfoot}>\n            <th\n               colSpan=\"2\"\n              style={this.styles.th}>{intl['total']}</th>\n            <td style={this.styles.total}>{total}</td>\n          </tr>\n        </tfoot>\n      </MJTable>\n    )\n  }\n\n}\n\nexport default Invoice\n"],"sourceRoot":"/source/"}